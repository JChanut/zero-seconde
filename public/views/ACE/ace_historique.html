<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">

<div class="row">
    <div class="col s12 z-depth-4 card-panel">
        <table class="table-responsive bordered centered" ng-controlle="historiqueCtrl">
            <thead>
            <tr>
                <th data-field="id">N° train</th>
                <th data-field="retard">OD</th>
                <th data-field="temps">En retard ?</th>
                <th >Unité du retard</th>
                <th >Cause du retard</th>
                <th >Commentaire</th>
                <th >Durée du retard</th>
            </tr>
            </thead>

            <tbody>
            <tr ng-repeat="ret in retards" e-ng-change="nimporte($data)">
                <td>
                    {{ret.num_train}}
                </td>
                <td>{{ret.nom}}</td>
                <td>
                    <span editable-text="ret.retard" e-name="retard" e-form="rowform"  e-required>
                        {{(ret.retard==1)?"Oui":"Non"}}
                    </span>
                </td>
                <td>
                    <span editable-select="ret.id_unite" e-name="id_unite" onbeforesave="updateUnite($data, ret, $index)" e-form="rowform" e-ng-options="u.id_unite as u.libelle_unite for u in unites">
                        {{ showUnites(ret.id_unite) }}
                    </span>
                </td>
                <td>
                    <span editable-select="ret.id_retard" onbeforesave="updateRetard($data, ret)" e-name="id_retard" e-form="rowform" e-ng-options="m.id_retard as m.libelle_motif for m in motifs">
                        {{ showMotifs(ret.id_retard,$index)}}
                    </span>
                </td>
                <td>
                    <span editable-text="ret.commentaire" e-name="commentaire" e-form="rowform">
                        {{ret.commentaire || "/"}}
                    </span>
                </td>
                <td>
                    <span editable-text="ret.duree_retard" e-name="duree_retard" e-form="rowform">
                        {{ret.duree_retard || "<1min"}}
                    </span>
                </td>
                <td style="white-space: nowrap">
                    <!-- form -->
                    <form editable-form name="rowform" ng-show="rowform.$visible" class="form-buttons form-inline">
                        <button type="submit" ng-disabled="rowform.$waiting" ng-click="updateHisto($index)" class="btn btn-primary">
                            Sauvegarder
                        </button>
                        <button type="button" ng-disabled="rowform.$waiting" ng-click="rowform.$cancel()" class="btn btn-default">
                            Annuler
                        </button>
                    </form>
                    <div class="buttons" ng-show="!rowform.$visible">
                        <button class="btn btn-primary" ng-click="rowform.$show()">Modifier</button>
                        <button class="btn btn-danger" ng-click="removeUser(ret.id_historique)">Supprimer</button>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>

    </div>
</div>

